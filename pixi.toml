[workspace]
authors = ["udit-asopa <udit.asopa@gmail.com>"]
channels = ["conda-forge"]
name = "similarity_search_chromadb"
platforms = ["linux-64"]
version = "0.1.0"

[tasks]
# Original script
run = "python script.py"

# Book exercises
books = "python exercises/books_advanced_search.py"
books-solution = "python exercises/books_advanced_search_solution.py"
books-bonus = "python exercises/books_bonus_features.py"

# FastAPI server tasks
serve = "python api/main.py"
dev = "uvicorn api.main:app --reload --host 0.0.0.0 --port 8000"
prod = "uvicorn api.main:app --host 0.0.0.0 --port 8000 --workers 4"

# Utility tasks
install = "pixi install"
health = "curl -s http://localhost:8000/health | python -m json.tool"
test-api = "curl -s http://localhost:8000/docs"

# Test tasks
test = { cmd = "pytest tests/ -v", env = { PYTHONPATH = "." } }
test-cov = { cmd = "pytest tests/ -v --cov=api --cov=exercises --cov-report=html --cov-report=term", env = { PYTHONPATH = "." } }
test-unit = { cmd = "pytest tests/unit/ -v", env = { PYTHONPATH = "." } }
test-integration = { cmd = "pytest tests/integration/ -v", env = { PYTHONPATH = "." } }
test-api-tests = { cmd = "pytest tests/api/ -v", env = { PYTHONPATH = "." } }
test-e2e = { cmd = "pytest tests/e2e/ -v", env = { PYTHONPATH = "." } }
test-perf = { cmd = "pytest tests/performance/ -v --benchmark-only", env = { PYTHONPATH = "." } }
test-watch = { cmd = "pytest tests/ -v --watch", env = { PYTHONPATH = "." } }
test-basic = { cmd = "pytest tests/unit/test_basic.py tests/test_setup.py -v", env = { PYTHONPATH = "." } }
run-tests = "bash run_tests.sh"

[dependencies]
chromadb = ">=0.4.0"
sentence-transformers = ">=2.2.0"
fastapi = ">=0.104.0"
uvicorn = ">=0.24.0"
pydantic = ">=2.0.0"
python-multipart = ">=0.0.6"

# Test dependencies  
pytest = ">=7.4.0"
pytest-asyncio = ">=0.21.0"
pytest-cov = ">=4.1.0"
httpx = ">=0.24.0"
pytest-mock = ">=3.11.0"
faker = ">=19.0.0"
psutil = ">=5.9.0"
